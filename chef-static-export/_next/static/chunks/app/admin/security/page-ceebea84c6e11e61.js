(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9636],{2898:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});var a=s(2265),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(e,t)=>{let s=(0,a.forwardRef)(({color:s="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:c,children:d,...o},m)=>(0,a.createElement)("svg",{ref:m,...i,width:n,height:n,stroke:s,strokeWidth:c?24*Number(l)/Number(n):l,className:`lucide lucide-${r(e)}`,...o},[...t.map(([e,t])=>(0,a.createElement)(e,t)),...(Array.isArray(d)?d:[d])||[]]));return s.displayName=`${e}`,s}},2894:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3021:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},8203:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3008:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6141:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},5817:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},9670:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},6637:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]])},5589:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},6142:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},9617:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},9883:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1827:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9036:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},1271:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},5750:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2369:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(2898);let i=(0,a.Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]])},5211:function(e,t,s){Promise.resolve().then(s.bind(s,7044))},7044:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return q}});var a=s(7437),i=s(2265),r=s(6637),n=s(5589),l=s(5750),c=s(9036),d=s(1827),o=s(5817),m=s(2894),x=s(2898);let u=(0,x.Z)("AlertOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var p=s(3021);let g=(0,x.Z)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),h=(0,x.Z)("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),File=(0,x.Z)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);var y=s(3008),j=s(6141);let f=(0,x.Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),v=(0,x.Z)("Fingerprint",[["path",{d:"M2 12C2 6.5 6.5 2 12 2a10 10 0 0 1 8 4",key:"1jc9o5"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12c0-.7.12-1.37.34-2",key:"1mxgy1"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2c0 .47 0 1.17-.02 2",key:"1fgabc"}]]),b=(0,x.Z)("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);var N=s(6142),w=s(1271);let S=(0,x.Z)("Chrome",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["line",{x1:"21.17",x2:"12",y1:"8",y2:"8",key:"a0cw5f"}],["line",{x1:"3.95",x2:"8.54",y1:"6.06",y2:"14",key:"1kftof"}],["line",{x1:"10.88",x2:"15.46",y1:"21.94",y2:"14",key:"1ymyh8"}]]);var k=s(8203),A=s(2369),D=s(9883),I=s(9617);let _=(0,x.Z)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var L=s(9670);let C="admin_security_data";function O(){let e=localStorage.getItem(C);if(e)return JSON.parse(e);let t=function(){let e=new Date().toISOString(),t=new Date(Date.now()-864e5).toISOString(),s=new Date(Date.now()-6048e5).toISOString(),a=[],i=[{action:"Admin login",actionType:"login",targetType:"system"},{action:"User account suspended",actionType:"update",targetType:"user"},{action:"Restaurant approved",actionType:"update",targetType:"restaurant"},{action:"Booking cancelled",actionType:"update",targetType:"booking"},{action:"Content moderated",actionType:"update",targetType:"content"},{action:"Failed login attempt",actionType:"login",targetType:"system"},{action:"Data export requested",actionType:"read",targetType:"data"},{action:"Security settings changed",actionType:"update",targetType:"system"}],r=["admin@restaurantbook.com","manager@restaurantbook.com","support@restaurantbook.com"],n=["192.168.1.100","10.0.0.50","203.0.113.42","198.51.100.25"],l=["New York, US","London, UK","Toronto, CA","Sydney, AU"];for(let e=0;e<50;e++){let t=i[Math.floor(Math.random()*i.length)],s=r[Math.floor(Math.random()*r.length)],c=n[Math.floor(Math.random()*n.length)],d=l[Math.floor(Math.random()*l.length)],o=Math.random()>.1;a.push({id:"audit_".concat(e+1),timestamp:new Date(Date.now()-6048e5*Math.random()).toISOString(),userId:"user_".concat(Math.floor(100*Math.random())),userEmail:s,userRole:s.includes("admin")?"admin":s.includes("manager")?"manager":"support",action:t.action,actionType:t.actionType,targetType:t.targetType,targetId:"system"!==t.targetType?"".concat(t.targetType,"_").concat(Math.floor(1e3*Math.random())):null,ipAddress:c,userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",sessionId:"session_".concat(Math.random().toString(36).substr(2,9)),status:o?"success":"failed",details:"".concat(t.action," performed from ").concat(d),riskLevel:t.action.includes("Failed")?"high":o?"low":"medium",location:d})}let c=[{id:"incident_1",incidentNumber:"SEC-2025-001",title:"Multiple failed login attempts detected",description:"Automated system detected 15 failed login attempts from IP 203.0.113.42 within 10 minutes",severity:"medium",category:"authentication",status:"resolved",reportedBy:"Security System",assignedTo:"security@restaurantbook.com",reportedAt:t,detectedAt:t,resolvedAt:new Date(Date.now()-216e5).toISOString(),affectedSystems:["Authentication Service","Admin Panel"],affectedUsers:0,impactAssessment:"Low impact - potential brute force attempt blocked by rate limiting",responseActions:[{id:"action_1",incidentId:"incident_1",action:"IP address temporarily blocked",performedBy:"security@restaurantbook.com",performedAt:t,status:"completed",details:"Added IP to temporary block list for 24 hours"}],evidence:["auth_logs_20251028.log","rate_limit_events.json"],rootCause:"Automated brute force attempt from compromised network",prevention:"Enhanced rate limiting implemented, CAPTCHA after 3 failed attempts",tags:["brute-force","authentication","automated"]},{id:"incident_2",incidentNumber:"SEC-2025-002",title:"Unusual data access pattern detected",description:"Admin user accessed large volume of customer data outside normal hours",severity:"high",category:"authorization",status:"investigating",reportedBy:"Data Loss Prevention System",assignedTo:"security@restaurantbook.com",reportedAt:new Date(Date.now()-144e5).toISOString(),detectedAt:new Date(Date.now()-144e5).toISOString(),resolvedAt:null,affectedSystems:["User Management","Database"],affectedUsers:1500,impactAssessment:"Potential data breach - investigating legitimate business need",responseActions:[{id:"action_2",incidentId:"incident_2",action:"Admin account temporarily suspended",performedBy:"security@restaurantbook.com",performedAt:new Date(Date.now()-108e5).toISOString(),status:"completed",details:"Account suspended pending investigation"}],evidence:["admin_access_logs.csv","database_query_logs.json"],tags:["data-access","insider-threat","investigation"]},{id:"incident_3",incidentNumber:"SEC-2025-003",title:"DDoS attack attempt detected",description:"High volume of requests from multiple IPs targeting API endpoints",severity:"critical",category:"ddos",status:"contained",reportedBy:"Infrastructure Monitoring",assignedTo:"devops@restaurantbook.com",reportedAt:new Date(Date.now()-72e5).toISOString(),detectedAt:new Date(Date.now()-72e5).toISOString(),resolvedAt:null,affectedSystems:["API Gateway","Load Balancer","Database"],affectedUsers:5e3,impactAssessment:"Service degradation - 30% reduction in response times",responseActions:[{id:"action_3",incidentId:"incident_3",action:"DDoS protection activated",performedBy:"devops@restaurantbook.com",performedAt:new Date(Date.now()-54e5).toISOString(),status:"completed",details:"Cloudflare DDoS protection enabled, malicious traffic filtered"}],evidence:["traffic_logs_20251028.gz","cloudflare_metrics.json"],tags:["ddos","infrastructure","service-disruption"]}],d=[{id:"compliance_1",framework:"GDPR",requirement:"Article 32 - Security of processing",description:"Implement appropriate technical and organizational measures to ensure security",status:"compliant",lastAssessed:s,nextAssessment:new Date(Date.now()+7776e6).toISOString(),responsibleParty:"Data Protection Officer",evidence:["encryption_audit_2025.pdf","security_measures_checklist.docx"],remediationActions:[],riskLevel:"low",notes:"All data encrypted at rest and in transit. Regular security assessments conducted."},{id:"compliance_2",framework:"GDPR",requirement:"Article 25 - Data protection by design and by default",description:"Implement data protection principles at the design stage and throughout processing",status:"partial",lastAssessed:s,nextAssessment:new Date(Date.now()+2592e6).toISOString(),responsibleParty:"Engineering Team",evidence:["privacy_impact_assessment.pdf"],remediationActions:["Implement privacy-by-design training","Update development guidelines"],riskLevel:"medium",notes:"Some legacy systems need privacy-by-design improvements"},{id:"compliance_3",framework:"CCPA",requirement:"Right to Delete",description:"Consumers have the right to request deletion of personal information",status:"compliant",lastAssessed:new Date(Date.now()-2592e6).toISOString(),nextAssessment:new Date(Date.now()+5184e6).toISOString(),responsibleParty:"Privacy Team",evidence:["deletion_process_documentation.pdf","deletion_audit_trail.csv"],remediationActions:[],riskLevel:"low",notes:"Automated deletion process implemented with audit trail"},{id:"compliance_4",framework:"ISO27001",requirement:"A.9.2.1 User registration and de-registration",description:"Formal user registration and de-registration process",status:"compliant",lastAssessed:new Date(Date.now()-3888e6).toISOString(),nextAssessment:new Date(Date.now()+648e7).toISOString(),responsibleParty:"IT Security",evidence:["user_management_procedures.pdf","access_review_2025_q4.xlsx"],remediationActions:[],riskLevel:"low",notes:"Quarterly access reviews conducted, automated provisioning/deprovisioning in place"}],o=[{id:"privacy_1",requestNumber:"PRIV-2025-001",type:"access",userId:"user_123",userEmail:"john.doe@example.com",requestedAt:new Date(Date.now()-432e6).toISOString(),status:"completed",processedBy:"privacy@restaurantbook.com",processedAt:new Date(Date.now()-1728e5).toISOString(),details:"User requested access to all personal data held by the platform",dataTypes:["Profile Information","Booking History","Payment Data","Communication Records"],legalBasis:"GDPR Article 15",responseDeadline:new Date(Date.now()+216e7).toISOString(),completionNotes:"Data package provided via secure download link"},{id:"privacy_2",requestNumber:"PRIV-2025-002",type:"erasure",userId:"user_456",userEmail:"jane.smith@example.com",requestedAt:new Date(Date.now()-2592e5).toISOString(),status:"processing",processedBy:"privacy@restaurantbook.com",processedAt:null,details:"User requested complete account deletion and data erasure",dataTypes:["All Personal Data"],legalBasis:"GDPR Article 17",responseDeadline:new Date(Date.now()+23328e5).toISOString()},{id:"privacy_3",requestNumber:"PRIV-2025-003",type:"rectification",userId:"user_789",userEmail:"mike.johnson@example.com",requestedAt:new Date(Date.now()-864e5).toISOString(),status:"pending",processedBy:null,processedAt:null,details:"User requested correction of incorrect address information",dataTypes:["Address Information"],legalBasis:"GDPR Article 16",responseDeadline:new Date(Date.now()+25056e5).toISOString()}],m=[{id:"activity_1",adminId:"admin_1",adminEmail:"admin@restaurantbook.com",sessionId:"session_abc123",loginAt:new Date(Date.now()-144e5).toISOString(),logoutAt:new Date(Date.now()-36e5).toISOString(),ipAddress:"192.168.1.100",location:"New York, US",device:"Desktop",browser:"Chrome 119.0",activeDuration:180,actionsPerformed:25,systemsAccessed:["User Management","Restaurant Management","Analytics"],riskScore:15,anomalies:[],twoFactorUsed:!0},{id:"activity_2",adminId:"admin_2",adminEmail:"manager@restaurantbook.com",sessionId:"session_def456",loginAt:new Date(Date.now()-288e5).toISOString(),logoutAt:null,ipAddress:"10.0.0.50",location:"London, UK",device:"Laptop",browser:"Firefox 118.0",activeDuration:480,actionsPerformed:67,systemsAccessed:["Booking Management","Content Moderation","Support"],riskScore:85,anomalies:["Unusual time of access","High volume of data access"],twoFactorUsed:!1}],x=[{id:"policy_1",name:"Password Policy",category:"access_control",description:"Requirements for secure password creation and management",policy:"Passwords must be at least 12 characters long, contain uppercase, lowercase, numbers, and special characters. Must be changed every 90 days.",version:"2.1",effectiveDate:new Date(Date.now()-2592e6).toISOString(),reviewDate:new Date(Date.now()+28944e6).toISOString(),owner:"IT Security Team",status:"active",violations:3,lastViolation:new Date(Date.now()-432e6).toISOString(),enforcement:"automatic"},{id:"policy_2",name:"Data Retention Policy",category:"data_protection",description:"Guidelines for data retention and disposal",policy:"Personal data must be retained only as long as necessary for business purposes. Customer data deleted after 7 years of inactivity.",version:"1.3",effectiveDate:new Date(Date.now()-5184e6).toISOString(),reviewDate:new Date(Date.now()+26352e6).toISOString(),owner:"Data Protection Officer",status:"active",violations:0,lastViolation:null,enforcement:"automatic"},{id:"policy_3",name:"Incident Response Policy",category:"incident_response",description:"Procedures for handling security incidents",policy:"All security incidents must be reported within 1 hour of detection. Critical incidents require immediate escalation to CISO.",version:"3.0",effectiveDate:new Date(Date.now()-1296e6).toISOString(),reviewDate:new Date(Date.now()+3024e7).toISOString(),owner:"Security Operations",status:"active",violations:1,lastViolation:new Date(Date.now()-864e6).toISOString(),enforcement:"manual"}],u=[{id:"alert_1",type:"failed_login",severity:"warning",title:"Multiple failed login attempts",description:"5 failed login attempts detected for admin@restaurantbook.com",source:"Authentication Service",triggeredAt:new Date(Date.now()-18e5).toISOString(),acknowledgedBy:null,acknowledgedAt:null,resolved:!1,resolvedAt:null,affectedEntities:["admin@restaurantbook.com"],recommendedActions:["Reset password","Enable 2FA","Check account activity"]},{id:"alert_2",type:"unusual_access",severity:"error",title:"Admin access from new location",description:"Admin user logged in from unusual geographic location",source:"Access Monitor",triggeredAt:new Date(Date.now()-72e5).toISOString(),acknowledgedBy:"security@restaurantbook.com",acknowledgedAt:new Date(Date.now()-36e5).toISOString(),resolved:!0,resolvedAt:new Date(Date.now()-36e5).toISOString(),affectedEntities:["manager@restaurantbook.com"],recommendedActions:["Verify with user","Check device fingerprint"]}],p={totalAuditLogs:a.length,activeIncidents:c.filter(e=>"closed"!==e.status&&"resolved"!==e.status).length,criticalIncidents:c.filter(e=>"critical"===e.severity).length,complianceScore:87,failedLogins24h:a.filter(e=>"failed"===e.status&&"login"===e.actionType).length,activeAdminSessions:m.filter(e=>!e.logoutAt).length,dataBreaches:0,securityScore:92,lastSecurityScan:t,vulnerabilities:{critical:0,high:2,medium:8,low:15},compliance:{gdpr:94,ccpa:91,iso27001:88,soc2:85}};return{auditLogs:a,incidents:c,complianceRecords:d,privacyRequests:o,adminActivities:m,securityPolicies:x,securityAlerts:u,metrics:p,lastUpdated:e}}();return localStorage.setItem(C,JSON.stringify(t)),t}function Z(){let e=O();return e.auditLogs}function R(){let e=O();return e.incidents}function P(){let e=O();return e.complianceRecords}function M(){let e=Z(),t=e.map(e=>[e.timestamp,e.userEmail,e.action,e.targetType,e.ipAddress,e.status,e.riskLevel,e.location]),s=[["Timestamp","User","Action","Target Type","IP Address","Status","Risk Level","Location"],...t].map(e=>e.join(",")).join("\n"),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download="audit-logs-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(i)}function T(){let e=P(),t=e.map(e=>[e.framework,e.requirement,e.status,e.riskLevel,e.lastAssessed,e.nextAssessment,e.responsibleParty]),s=[["Framework","Requirement","Status","Risk Level","Last Assessed","Next Assessment","Responsible Party"],...t].map(e=>e.join(",")).join("\n"),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download="compliance-report-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(i)}function U(){let e=R(),t=e.map(e=>[e.incidentNumber,e.title,e.severity,e.category,e.status,e.reportedAt,e.resolvedAt||"N/A",e.affectedUsers]),s=[["Incident Number","Title","Severity","Category","Status","Reported At","Resolved At","Affected Users"],...t].map(e=>e.join(",")).join("\n"),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download="security-incidents-".concat(new Date().toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(i)}function q(){let[e,t]=(0,i.useState)("audit"),[s,x]=(0,i.useState)([]),[q,E]=(0,i.useState)([]),[B,z]=(0,i.useState)([]),[F,V]=(0,i.useState)([]),[H,G]=(0,i.useState)([]),[J,W]=(0,i.useState)([]),[$,K]=(0,i.useState)([]),[Y,Q]=(0,i.useState)(null),[X,ee]=(0,i.useState)(!1),[et,es]=(0,i.useState)(!1),[ea,ei]=(0,i.useState)(!1),[er,en]=(0,i.useState)(null),[el,ec]=(0,i.useState)(null),[ed,eo]=(0,i.useState)(null),[em,ex]=(0,i.useState)(""),[eu,ep]=(0,i.useState)("all"),[eg,eh]=(0,i.useState)("all"),[ey,ej]=(0,i.useState)("7d");(0,i.useEffect)(()=>{ef()},[]);let ef=()=>{x(Z()),E(R()),z(P()),V(function(){let e=O();return e.privacyRequests}()),G(function(){let e=O();return e.adminActivities}()),W(function(){let e=O();return e.securityPolicies}()),K(function(){let e=O();return e.securityAlerts}()),Q(function(){let e=O();return e.metrics}())},ev=s.filter(e=>{let t=e.action.toLowerCase().includes(em.toLowerCase())||e.userEmail.toLowerCase().includes(em.toLowerCase()),s="all"===eu||e.status===eu,a="all"===eg||e.riskLevel===eg;return t&&s&&a}),eb=q.filter(e=>{let t=e.title.toLowerCase().includes(em.toLowerCase())||e.description.toLowerCase().includes(em.toLowerCase()),s="all"===eu||e.status===eu,a="all"===eg||e.severity===eg;return t&&s&&a}),eN=(e,t)=>{let s={status:t};("resolved"===t||"closed"===t)&&(s.resolvedAt=new Date().toISOString()),function(e,t){let s=O(),a=s.incidents.findIndex(t=>t.id===e);-1!==a&&(s.incidents[a]={...s.incidents[a],...t},localStorage.setItem(C,JSON.stringify(s)))}(e,s),ef(),eI("Incident ".concat(t," successfully"))},ew=(e,t)=>{!function(e,t){let s=O(),a=s.incidents.find(t=>t.id===e);if(a){let e={...t,id:"action_".concat(Date.now())};a.responseActions.push(e),localStorage.setItem(C,JSON.stringify(s))}}(e,{action:t,performedBy:"security@restaurantbook.com",performedAt:new Date().toISOString(),status:"completed",details:t}),ef(),eI("Action added to incident")},eS=(e,t)=>{!function(e,t){let s=O(),a=s.complianceRecords.findIndex(t=>t.id===e);-1!==a&&(s.complianceRecords[a]={...s.complianceRecords[a],...t},localStorage.setItem(C,JSON.stringify(s)))}(e,{status:t,lastAssessed:new Date().toISOString()}),ef(),eI("Compliance status updated")},ek=(e,t)=>{let s={status:t};"completed"===t&&(s.processedAt=new Date().toISOString(),s.processedBy="privacy@restaurantbook.com"),function(e,t){let s=O(),a=s.privacyRequests.findIndex(t=>t.id===e);-1!==a&&(s.privacyRequests[a]={...s.privacyRequests[a],...t},localStorage.setItem(C,JSON.stringify(s)))}(e,s),ef(),eI("Privacy request updated")},eA=e=>{!function(e,t){let s=O(),a=s.securityAlerts.findIndex(t=>t.id===e);-1!==a&&(s.securityAlerts[a].acknowledgedBy=t,s.securityAlerts[a].acknowledgedAt=new Date().toISOString(),localStorage.setItem(C,JSON.stringify(s)))}(e,"security@restaurantbook.com"),ef(),eI("Alert acknowledged")},eD=e=>{!function(e){let t=O(),s=t.securityAlerts.findIndex(t=>t.id===e);-1!==s&&(t.securityAlerts[s].resolved=!0,t.securityAlerts[s].resolvedAt=new Date().toISOString(),localStorage.setItem(C,JSON.stringify(t)))}(e),ef(),eI("Alert resolved")},eI=e=>{let t=document.createElement("div");t.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg z-50",t.textContent=e,document.body.appendChild(t),setTimeout(()=>document.body.removeChild(t),3e3)},e_=e=>(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat({critical:"bg-red-200 text-red-900",high:"bg-orange-100 text-orange-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-blue-100 text-blue-800",info:"bg-blue-100 text-blue-800",warning:"bg-yellow-100 text-yellow-800",error:"bg-red-100 text-red-800"}[e]),children:e.toUpperCase()}),eL=e=>(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat({success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800",blocked:"bg-gray-100 text-gray-800",open:"bg-red-100 text-red-800",investigating:"bg-yellow-100 text-yellow-800",contained:"bg-orange-100 text-orange-800",resolved:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800",compliant:"bg-green-100 text-green-800",non_compliant:"bg-red-100 text-red-800",partial:"bg-yellow-100 text-yellow-800",not_applicable:"bg-gray-100 text-gray-800",pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",active:"bg-green-100 text-green-800",draft:"bg-yellow-100 text-yellow-800",archived:"bg-gray-100 text-gray-800"}[e]),children:e.replace("_"," ").toUpperCase()});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Security & Compliance"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Comprehensive security monitoring, compliance tracking, and audit capabilities"})]}),(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"flex space-x-8",children:[{id:"audit",name:"Audit Logs",icon:(0,a.jsx)(r.Z,{className:"w-4 h-4"})},{id:"monitoring",name:"Security Monitoring",icon:(0,a.jsx)(_,{className:"w-4 h-4"})},{id:"compliance",name:"Compliance",icon:(0,a.jsx)(h,{className:"w-4 h-4"})},{id:"privacy",name:"Data Privacy",icon:(0,a.jsx)(L.Z,{className:"w-4 h-4"})},{id:"activity",name:"Admin Activity",icon:(0,a.jsx)(f,{className:"w-4 h-4"})},{id:"policies",name:"Security Policies",icon:(0,a.jsx)(File,{className:"w-4 h-4"})}].map(s=>(0,a.jsxs)("button",{onClick:()=>t(s.id),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ".concat(e===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[s.icon,(0,a.jsx)("span",{children:s.name})]},s.id))})}),"audit"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Audit Logs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:(null==Y?void 0:Y.totalAuditLogs)||0})]}),(0,a.jsx)(r.Z,{className:"w-8 h-8 text-blue-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Failed Logins (24h)"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:(null==Y?void 0:Y.failedLogins24h)||0})]}),(0,a.jsx)(n.Z,{className:"w-8 h-8 text-red-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Admin Sessions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:(null==Y?void 0:Y.activeAdminSessions)||0})]}),(0,a.jsx)(l.Z,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Security Score"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[(null==Y?void 0:Y.securityScore)||0,"%"]})]}),(0,a.jsx)(c.Z,{className:"w-8 h-8 text-purple-600"})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,a.jsx)("div",{className:"flex-1 min-w-64",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search audit logs...",value:em,onChange:e=>ex(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),(0,a.jsxs)("select",{value:eu,onChange:e=>ep(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"success",children:"Success"}),(0,a.jsx)("option",{value:"failed",children:"Failed"}),(0,a.jsx)("option",{value:"blocked",children:"Blocked"})]}),(0,a.jsxs)("select",{value:eg,onChange:e=>eh(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Risk Levels"}),(0,a.jsx)("option",{value:"critical",children:"Critical"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"low",children:"Low"})]}),(0,a.jsxs)("select",{value:ey,onChange:e=>ej(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"1d",children:"Last 24 Hours"}),(0,a.jsx)("option",{value:"7d",children:"Last 7 Days"}),(0,a.jsx)("option",{value:"30d",children:"Last 30 Days"}),(0,a.jsx)("option",{value:"90d",children:"Last 90 Days"})]}),(0,a.jsxs)("button",{onClick:M,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Export"]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Audit Log Details"})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Target"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"IP Address"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Risk"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:ev.slice(0,20).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.timestamp).toLocaleString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.userEmail}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.userRole})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.action}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 capitalize",children:e.targetType}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-gray-900",children:e.ipAddress}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.location})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:eL(e.status)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e_(e.riskLevel)})]},e.id))})]})})]})]}),"monitoring"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Incidents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:(null==Y?void 0:Y.activeIncidents)||0})]}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-red-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Critical Incidents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:(null==Y?void 0:Y.criticalIncidents)||0})]}),(0,a.jsx)(u,{className:"w-8 h-8 text-orange-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Security Alerts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:$.filter(e=>!e.resolved).length})]}),(0,a.jsx)(p.Z,{className:"w-8 h-8 text-yellow-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Vulnerabilities"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:((null==Y?void 0:Y.vulnerabilities.critical)||0)+((null==Y?void 0:Y.vulnerabilities.high)||0)})]}),(0,a.jsx)(g,{className:"w-8 h-8 text-purple-600"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Live Security Alerts"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:[$.filter(e=>!e.resolved).length," unresolved"]})]})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:$.filter(e=>!e.resolved).map(e=>(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),e_(e.severity)]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mb-3",children:[(0,a.jsxs)("span",{children:["Source: ",e.source]}),(0,a.jsxs)("span",{children:["Triggered: ",new Date(e.triggeredAt).toLocaleString()]}),(0,a.jsxs)("span",{children:["Entities: ",e.affectedEntities.join(", ")]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.recommendedActions.map((e,t)=>(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e},t))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[!e.acknowledgedBy&&(0,a.jsx)("button",{onClick:()=>eA(e.id),className:"px-3 py-1 text-sm bg-yellow-600 text-white rounded hover:bg-yellow-700",children:"Acknowledge"}),(0,a.jsx)("button",{onClick:()=>eD(e.id),className:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700",children:"Resolve"})]})]})},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Security Incidents"}),(0,a.jsxs)("button",{onClick:U,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Export"]})]})}),(0,a.jsx)("div",{className:"space-y-4 p-6",children:eb.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.incidentNumber}),e_(e.severity),eL(e.status)]}),(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Category"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:e.category})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Reported"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.reportedAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Assigned To"}),(0,a.jsx)("p",{className:"font-medium",children:e.assignedTo||"Unassigned"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Affected Users"}),(0,a.jsx)("p",{className:"font-medium",children:e.affectedUsers})]})]}),e.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:e.tags.map((e,t)=>(0,a.jsx)("span",{className:"text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded",children:e},t))})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,a.jsx)("button",{onClick:()=>{en(e),ee(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Investigate"})})]})},e.id))})]})]}),"compliance"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Overall Score"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[(null==Y?void 0:Y.complianceScore)||0,"%"]})]}),(0,a.jsx)(h,{className:"w-8 h-8 text-blue-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"GDPR Score"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[(null==Y?void 0:Y.compliance.gdpr)||0,"%"]})]}),(0,a.jsx)(File,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"ISO 27001"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[(null==Y?void 0:Y.compliance.iso27001)||0,"%"]})]}),(0,a.jsx)(y.Z,{className:"w-8 h-8 text-purple-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"SOC 2"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:[(null==Y?void 0:Y.compliance.soc2)||0,"%"]})]}),(0,a.jsx)(c.Z,{className:"w-8 h-8 text-orange-600"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Compliance Framework Status"}),(0,a.jsxs)("button",{onClick:T,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})}),(0,a.jsx)("div",{className:"space-y-4 p-6",children:B.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-blue-600",children:e.framework}),eL(e.status),e_(e.riskLevel)]}),(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:e.requirement}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Last Assessed"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.lastAssessed).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Next Assessment"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.nextAssessment).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Responsible Party"}),(0,a.jsx)("p",{className:"font-medium",children:e.responsibleParty})]})]}),e.remediationActions.length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Remediation Actions:"}),(0,a.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:e.remediationActions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-orange-400 rounded-full mr-2"}),e]},t))})]}),e.notes&&(0,a.jsx)("p",{className:"text-sm text-gray-600 italic",children:e.notes})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,a.jsxs)("select",{value:e.status,onChange:t=>eS(e.id,t.target.value),className:"px-3 py-1 text-sm border border-gray-300 rounded",children:[(0,a.jsx)("option",{value:"compliant",children:"Compliant"}),(0,a.jsx)("option",{value:"non_compliant",children:"Non-Compliant"}),(0,a.jsx)("option",{value:"partial",children:"Partial"}),(0,a.jsx)("option",{value:"not_applicable",children:"Not Applicable"})]})})]})},e.id))})]})]}),"privacy"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Privacy Requests"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:F.length})]}),(0,a.jsx)(r.Z,{className:"w-8 h-8 text-blue-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending Requests"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:F.filter(e=>"pending"===e.status).length})]}),(0,a.jsx)(j.Z,{className:"w-8 h-8 text-yellow-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Completed Today"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:F.filter(e=>"completed"===e.status).length})]}),(0,a.jsx)(y.Z,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Data Breaches"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:(null==Y?void 0:Y.dataBreaches)||0})]}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-red-600"})]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Request Types"}),(0,a.jsx)("div",{className:"space-y-3",children:["access","rectification","erasure","portability","restriction","objection"].map(e=>{let t=F.filter(t=>t.type===e).length;return(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 capitalize",children:e}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:"".concat(t/F.length*100,"%")}})}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t})]})]},e)})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Processing Times"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.Z,{className:"w-5 h-5 text-green-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Average Response Time"})]}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:"2.3 days"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 text-blue-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"SLA Compliance"})]}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:"96%"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-purple-600 mr-3"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Requests This Month"})]}),(0,a.jsx)("span",{className:"text-sm font-bold text-gray-900",children:"127"})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Privacy Requests"})}),(0,a.jsx)("div",{className:"space-y-4 p-6",children:F.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.requestNumber}),(0,a.jsx)("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded capitalize",children:e.type}),eL(e.status)]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"User"}),(0,a.jsx)("p",{className:"font-medium",children:e.userEmail})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Requested"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.requestedAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Deadline"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.responseDeadline).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Legal Basis"}),(0,a.jsx)("p",{className:"font-medium",children:e.legalBasis})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.details}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.dataTypes.map((e,t)=>(0,a.jsx)("span",{className:"text-xs bg-gray-100 text-gray-800 px-2 py-1 rounded",children:e},t))})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,a.jsxs)("select",{value:e.status,onChange:t=>ek(e.id,t.target.value),className:"px-3 py-1 text-sm border border-gray-300 rounded",children:[(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"processing",children:"Processing"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,a.jsx)("button",{onClick:()=>{ec(e),es(!0)},className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"View"})]})]})},e.id))})]})]}),"activity"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Sessions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:H.filter(e=>!e.logoutAt).length})]}),(0,a.jsx)(f,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"2FA Usage"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[Math.round(H.filter(e=>e.twoFactorUsed).length/H.length*100),"%"]})]}),(0,a.jsx)(v,{className:"w-8 h-8 text-blue-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"High Risk Sessions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:H.filter(e=>e.riskScore>70).length})]}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-red-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Avg Session Time"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[Math.round(H.reduce((e,t)=>e+t.activeDuration,0)/H.length),"m"]})]}),(0,a.jsx)(j.Z,{className:"w-8 h-8 text-purple-600"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Admin Session Activity"})}),(0,a.jsx)("div",{className:"space-y-4 p-6",children:H.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900",children:e.adminEmail}),e.riskScore>70&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"High Risk"}),e.twoFactorUsed?(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"2FA"}):(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"No 2FA"}),!e.logoutAt&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Active"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(b,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"IP Address"}),(0,a.jsx)("p",{className:"font-medium",children:e.ipAddress})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Location"}),(0,a.jsx)("p",{className:"font-medium",children:e.location})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(w.Z,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Device"}),(0,a.jsx)("p",{className:"font-medium",children:e.device})]})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(S,{className:"w-4 h-4 mr-2 text-gray-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Browser"}),(0,a.jsx)("p",{className:"font-medium",children:e.browser})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Login Time"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.loginAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Session Duration"}),(0,a.jsxs)("p",{className:"font-medium",children:[e.activeDuration," minutes"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Actions Performed"}),(0,a.jsx)("p",{className:"font-medium",children:e.actionsPerformed})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Risk Score"}),(0,a.jsxs)("p",{className:"font-medium ".concat(e.riskScore>70?"text-red-600":e.riskScore>40?"text-yellow-600":"text-green-600"),children:[e.riskScore,"/100"]})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:e.systemsAccessed.map((e,t)=>(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:e},t))}),e.anomalies.length>0&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-700",children:"Anomalies Detected:"}),e.anomalies.map((e,t)=>(0,a.jsxs)("p",{className:"text-sm text-red-600 flex items-center",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),e]},t))]})]})})},e.id))})]})]}),"policies"===e&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Active Policies"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600 mt-1",children:J.filter(e=>"active"===e.status).length})]}),(0,a.jsx)(File,{className:"w-8 h-8 text-green-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Policy Violations"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600 mt-1",children:J.reduce((e,t)=>e+t.violations,0)})]}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-red-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Due for Review"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:J.filter(e=>new Date(e.reviewDate)<new Date(Date.now()+2592e6)).length})]}),(0,a.jsx)(k.Z,{className:"w-8 h-8 text-yellow-600"})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Auto Enforced"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:J.filter(e=>"automatic"===e.enforcement).length})]}),(0,a.jsx)(A.Z,{className:"w-8 h-8 text-blue-600"})]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Security Policies"}),(0,a.jsxs)("button",{onClick:()=>ei(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 mr-2"}),"New Policy"]})]})}),(0,a.jsx)("div",{className:"space-y-4 p-6",children:J.map(e=>(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),eL(e.status),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["v",e.version]}),"automatic"===e.enforcement&&(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:"Auto Enforced"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-gray-600 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Category"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:e.category.replace("_"," ")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Owner"}),(0,a.jsx)("p",{className:"font-medium",children:e.owner})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Effective Date"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.effectiveDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-500",children:"Next Review"}),(0,a.jsx)("p",{className:"font-medium",children:new Date(e.reviewDate).toLocaleDateString()})]})]}),e.violations>0&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:[e.violations," violations"]}),e.lastViolation&&(0,a.jsxs)("span",{children:[" Last: ",new Date(e.lastViolation).toLocaleDateString()]})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,a.jsx)("button",{onClick:()=>{eo(e),ei(!0)},className:"p-2 text-gray-600 hover:text-blue-600",children:(0,a.jsx)(I.Z,{className:"w-4 h-4"})})})]})},e.id))})]})]}),X&&er&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-screen overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Incident Investigation - ",er.incidentNumber]}),(0,a.jsx)("button",{onClick:()=>ee(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Incident Details"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Title:"})," ",er.title]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Category:"})," ",er.category]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Severity:"})," ",er.severity]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Status:"})," ",er.status]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Affected Users:"})," ",er.affectedUsers]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Assigned To:"})," ",er.assignedTo||"Unassigned"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Timeline"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Detected:"})," ",new Date(er.detectedAt).toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Reported:"})," ",new Date(er.reportedAt).toLocaleString()]}),er.resolvedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Resolved:"})," ",new Date(er.resolvedAt).toLocaleString()]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Impact Assessment"}),(0,a.jsx)("p",{className:"text-sm text-gray-700",children:er.impactAssessment})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-4",children:"Response Actions"}),(0,a.jsx)("div",{className:"space-y-3",children:er.responseActions.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("span",{className:"font-medium text-sm",children:e.action}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat("completed"===e.status?"bg-green-100 text-green-800":"failed"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.details}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["By ",e.performedBy," at ",new Date(e.performedAt).toLocaleString()]})]},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Add Action"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Describe the action taken...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm",onKeyDown:e=>{if("Enter"===e.key){let t=e.target.value;t.trim()&&(ew(er.id,t),e.target.value="")}}}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm",children:"Add Action"})]})]}),(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsxs)("select",{value:er.status,onChange:e=>eN(er.id,e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg",children:[(0,a.jsx)("option",{value:"open",children:"Open"}),(0,a.jsx)("option",{value:"investigating",children:"Investigating"}),(0,a.jsx)("option",{value:"contained",children:"Contained"}),(0,a.jsx)("option",{value:"resolved",children:"Resolved"}),(0,a.jsx)("option",{value:"closed",children:"Closed"})]})})]})]})})]})}},622:function(e,t,s){"use strict";var a=s(2265),i=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,s){var a,r={},d=null,o=null;for(a in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(o=t.ref),t)n.call(t,a)&&!c.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:i,type:e,key:d,ref:o,props:r,_owner:l.current}}t.Fragment=r,t.jsx=d,t.jsxs=d},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[2971,2472,1744],function(){return e(e.s=5211)}),_N_E=e.O()}]);